{"version":3,"file":"menu.bundle.js","sources":["../src/build-tree.js","../src/make-flat-tree.js","../src/get-node-class.js","../src/menu.js"],"sourcesContent":["export default function buildTree(root: HTMLElement, selector, parent = null, depth = 0)\n{\n\treturn [...root.querySelectorAll(selector)]\n\t\t.filter((element) => {\n\t\t\treturn element.parentElement.closest(selector) === parent;\n\t\t})\n\t\t.map((element) => {\n\t\t\tconst newDepth = depth + 1;\n\t\t\treturn {\n\t\t\t\tlayout: element,\n\t\t\t\tchildren: buildTree(element, selector, element, newDepth),\n\t\t\t\tdepth,\n\t\t\t};\n\t\t});\n}","import {MenuItem} from 'landing.menu.menuitem';\n\nexport default function makeFlatTree(tree: Array<MenuItem>, acc = []): Array<MenuItem>\n{\n\ttree.forEach((item) => {\n\t\tacc.push(item);\n\t\tmakeFlatTree(item.children, acc);\n\t});\n\n\treturn acc;\n}","export default function getNodeClass(type)\n{\n\tif (type === 'link')\n\t{\n\t\treturn BX.Landing.Block.Node.Link;\n\t}\n\n\tif (type === 'img')\n\t{\n\t\treturn BX.Landing.Block.Node.Img;\n\t}\n\n\tif (type === 'icon')\n\t{\n\t\treturn BX.Landing.Block.Node.Icon;\n\t}\n\n\tif (type === 'embed')\n\t{\n\t\treturn BX.Landing.Block.Node.Embed;\n\t}\n\n\tif (type === 'map')\n\t{\n\t\treturn BX.Landing.Block.Node.Map;\n\t}\n\n\tif (type === 'component')\n\t{\n\t\treturn BX.Landing.Block.Node.Component;\n\t}\n\n\treturn BX.Landing.Block.Node.Text;\n}","import {Event, Cache, Tag, Dom, Type, Text} from 'main.core';\nimport {Loc} from 'landing.loc';\nimport {Env} from 'landing.env';\nimport {Main} from 'landing.main';\nimport {Backend} from 'landing.backend';\nimport {MenuItem} from 'landing.menu.menuitem';\nimport {MenuForm} from 'landing.ui.form.menuform';\nimport buildTree from './build-tree';\nimport makeFlatTree from './make-flat-tree';\nimport getNodeClass from './get-node-class';\n\nimport './css/style.css';\n\nexport class Menu extends Event.EventEmitter\n{\n\tconstructor(options = {})\n\t{\n\t\tsuper(options);\n\t\tthis.setEventNamespace('BX.Landing.Menu.Menu');\n\n\t\tthis.code = options.code;\n\t\tthis.root = options.root;\n\t\tthis.block = options.block;\n\t\tthis.manifest = Object.freeze({...options.manifest});\n\t\tthis.cache = new Cache.MemoryCache();\n\n\t\tif (\n\t\t\tEnv.getInstance().getType() === 'KNOWLEDGE'\n\t\t\t|| Env.getInstance().getType() === 'GROUP'\n\t\t)\n\t\t{\n\t\t\tif (Dom.hasClass(this.root.nextElementSibling, 'landing-menu-add'))\n\t\t\t{\n\t\t\t\tDom.remove(this.root.nextElementSibling);\n\t\t\t}\n\n\t\t\tDom.addClass(this.root, 'landing-menu-root-list');\n\t\t\tDom.insertAfter(this.getAddPageLayout(), this.root);\n\t\t}\n\n\t\tEvent.bind(this.root, 'click', (event: MouseEvent) => {\n\t\t\tif (event.target.nodeName === 'A')\n\t\t\t{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst href = Dom.attr(event.target, 'href');\n\t\t\t\tif (href.startsWith('#landing'))\n\t\t\t\t{\n\t\t\t\t\tconst pageId = Text.toNumber(href.replace('#landing', ''));\n\t\t\t\t\tthis.reloadPage(pageId);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcreateMenuItem(options): MenuItem\n\t{\n\t\tconst nodes = new BX.Landing.Collection.NodeCollection();\n\n\t\tObject.entries(this.manifest.nodes).forEach(([code, nodeManifest]) => {\n\t\t\tconst nodeElements = [\n\t\t\t\t...options.layout.querySelectorAll(code),\n\t\t\t].filter((nodeElement) => {\n\t\t\t\tconst elementParent = nodeElement.closest(this.manifest.item);\n\t\t\t\treturn elementParent === options.layout;\n\t\t\t});\n\n\t\t\tif (nodeElements.length > 0)\n\t\t\t{\n\t\t\t\tconst NodeClass = getNodeClass(nodeManifest.type);\n\n\t\t\t\tnodeElements.forEach((nodeElement) => {\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew NodeClass({\n\t\t\t\t\t\t\tnode: nodeElement,\n\t\t\t\t\t\t\tmanifest: {...nodeManifest, allowInlineEdit: false, menuMode: true},\n\t\t\t\t\t\t}),\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\treturn new MenuItem({\n\t\t\tlayout: options.layout,\n\t\t\tchildren: options.children.map((itemOptions, index) => {\n\t\t\t\treturn this.createMenuItem({...itemOptions, index});\n\t\t\t}),\n\t\t\tselector: `${this.manifest.item}@${options.index}`,\n\t\t\tdepth: options.depth,\n\t\t\tnodes,\n\t\t});\n\t}\n\n\tgetTree()\n\t{\n\t\tconst {item} = this.manifest;\n\t\treturn buildTree(this.root, item)\n\t\t\t.map((options, index) => this.createMenuItem({...options, index}));\n\t}\n\n\tgetFlatTree()\n\t{\n\t\treturn makeFlatTree(this.getTree());\n\t}\n\n\tgetForm(): MenuForm\n\t{\n\t\treturn new MenuForm({\n\t\t\ttitle: 'Menu',\n\t\t\ttype: 'menu',\n\t\t\tcode: this.code,\n\t\t\tforms: this.getFlatTree().map((item) => {\n\t\t\t\treturn item.getForm();\n\t\t\t}),\n\t\t});\n\t}\n\n\tgetAddPageButton(): HTMLButtonElement\n\t{\n\t\treturn this.cache.remember('addPageButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<button \n\t\t\t\t\tclass=\"ui-btn ui-btn-light-border ui-btn-icon-add ui-btn-round landing-ui-menu-add-button\"\n\t\t\t\t\tonclick=\"${this.onAddPageButtonClick.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t\t\t${Loc.getMessage('LANDING_MENU_CREATE_NEW_PAGE')}\n\t\t\t\t</button>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageTextInputKeydown(event: KeyboardEvent)\n\t{\n\t\tif (event.keyCode === 13)\n\t\t{\n\t\t\tconst input = this.getAddPageInput();\n\t\t\tconst {value} = input;\n\n\t\t\tinput.value = '';\n\t\t\tinput.focus();\n\n\t\t\tif (Type.isStringFilled(value))\n\t\t\t{\n\t\t\t\tconst code = BX.translit(\n\t\t\t\t\tvalue,\n\t\t\t\t\t{\n\t\t\t\t\t\tchange_case: 'L',\n\t\t\t\t\t\treplace_space: '-',\n\t\t\t\t\t\treplace_other: '',\n\t\t\t\t\t},\n\t\t\t\t);\n\n\t\t\t\tconst backend = Backend.getInstance();\n\n\t\t\t\tbackend\n\t\t\t\t\t.createPage({\n\t\t\t\t\t\ttitle: value,\n\t\t\t\t\t\tmenuCode: this.code,\n\t\t\t\t\t\tblockId: this.block,\n\t\t\t\t\t\tcode,\n\t\t\t\t\t})\n\t\t\t\t\t.then((id) => {\n\t\t\t\t\t\tconst li = this.createLi({\n\t\t\t\t\t\t\ttext: value,\n\t\t\t\t\t\t\thref: `#landing${id}`,\n\t\t\t\t\t\t\ttarget: '_self',\n\t\t\t\t\t\t\tchildren: [],\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tDom.append(li, this.root);\n\t\t\t\t\t\tDom.remove(this.getAddPageField());\n\t\t\t\t\t\tDom.removeClass(this.root, 'landing-menu-root-list-with-field');\n\n\t\t\t\t\t\tthis.reloadPage(id);\n\t\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\t// eslint-disable-next-line class-methods-use-this\n\treloadPage(id: number)\n\t{\n\t\tconst main = Main.getInstance();\n\t\tconst url = Env.getInstance().getLandingEditorUrl({\n\t\t\tlanding: id,\n\t\t});\n\n\t\tvoid main.reloadSlider(url);\n\t}\n\n\tgetAddPageInput(): TextField\n\t{\n\t\treturn this.cache.remember('addPageTextInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<input \n\t\t\t\t\ttype=\"text\" \n\t\t\t\t\tclass=\"landing-menu-add-field-input\"\n\t\t\t\t\tplaceholder=\"${Loc.getMessage('LANDING_MENU_CREATE_NEW_PAGE')}\"\n\t\t\t\t\tonkeydown=\"${this.onAddPageTextInputKeydown.bind(this)}\"\n\t\t\t\t\t>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageInputClearButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\n\t\tconst input = this.getAddPageInput();\n\n\t\tinput.value = '';\n\t\tinput.focus();\n\t}\n\n\tgetAddPageInputClearButton(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInputClearButton', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<span \n\t\t\t\t\tclass=\"landing-menu-add-field-clear\"\n\t\t\t\t\tonclick=\"${this.onAddPageInputClearButtonClick.bind(this)}\"\n\t\t\t\t\ttitle=\"${Loc.getMessage('LANDING_MENU_CLEAR_FIELD')}\"\n\t\t\t\t\t>\n\t\t\t\t</span>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddPageField(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageInput', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-menu-add-field\">\n\t\t\t\t\t${this.getAddPageInput()}\n\t\t\t\t\t${this.getAddPageInputClearButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tgetAddPageLayout(): HTMLElement\n\t{\n\t\treturn this.cache.remember('addPageLayout', () => {\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"landing-menu-add\">\n\t\t\t\t\t${this.getAddPageButton()}\n\t\t\t\t</div>\n\t\t\t`;\n\t\t});\n\t}\n\n\tonAddPageButtonClick(event: MouseEvent)\n\t{\n\t\tevent.preventDefault();\n\t\tDom.addClass(this.root, 'landing-menu-root-list-with-field');\n\t\tDom.prepend(this.getAddPageField(), this.getAddPageLayout());\n\t\tthis.getAddPageInput().focus();\n\t}\n\n\tcreateList(items, type = 'root')\n\t{\n\t\tconst {ulClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<ul class=\"${ulClassName}\">${items.map((item) => this.createLi(item, type))}</ul>\n\t\t`;\n\t}\n\n\tcreateA(item, type = 'root')\n\t{\n\t\tconst {aClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<a class=\"${aClassName}\" href=\"${item.href}\" target=\"${item.target}\">${Text.encode(item.text)}</a>\n\t\t`;\n\t}\n\n\tcreateLi(item, type = 'root')\n\t{\n\t\tconst {liClassName} = this.manifest[type];\n\t\treturn Tag.render`\n\t\t\t<li class=\"${liClassName}\">\n\t\t\t\t${this.createA(item, type)}\n\t\t\t\t${item.children ? this.createList(item.children, 'children') : undefined}\n\t\t\t</li>\n\t\t`;\n\t}\n\n\trebuild(items)\n\t{\n\t\tconst newList = this.createList(items);\n\n\t\tDom.replace(this.root, newList);\n\t\tthis.root = newList;\n\t}\n}"],"names":["buildTree","root","selector","parent","depth","querySelectorAll","filter","element","parentElement","closest","map","newDepth","layout","children","makeFlatTree","tree","acc","forEach","item","push","getNodeClass","type","BX","Landing","Block","Node","Link","Img","Icon","Embed","Map","Component","Text","Menu","options","setEventNamespace","code","block","manifest","Object","freeze","cache","Cache","MemoryCache","Env","getInstance","getType","Dom","hasClass","nextElementSibling","remove","addClass","insertAfter","getAddPageLayout","Event","bind","event","target","nodeName","preventDefault","href","attr","startsWith","pageId","toNumber","replace","reloadPage","nodes","Collection","NodeCollection","entries","nodeManifest","nodeElements","nodeElement","elementParent","length","NodeClass","node","allowInlineEdit","menuMode","MenuItem","itemOptions","index","createMenuItem","getTree","MenuForm","title","forms","getFlatTree","getForm","remember","Tag","render","onAddPageButtonClick","Loc","getMessage","keyCode","input","getAddPageInput","value","focus","Type","isStringFilled","translit","change_case","replace_space","replace_other","backend","Backend","createPage","menuCode","blockId","then","id","li","createLi","text","append","getAddPageField","removeClass","main","Main","url","getLandingEditorUrl","landing","reloadSlider","onAddPageTextInputKeydown","onAddPageInputClearButtonClick","getAddPageInputClearButton","getAddPageButton","prepend","items","ulClassName","aClassName","encode","liClassName","createA","createList","undefined","newList","EventEmitter"],"mappings":"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"}