{"version":3,"file":"userfieldfactory.bundle.js","sources":["../src/fieldtypes.js","../src/creationmenu.js","../src/enumitem.js","../src/field.js","../src/configurator.js","../src/factory.js","../src/userfieldfactory.js"],"sourcesContent":["import {Loc} from 'main.core';\n\nexport const MAX_FIELD_LENGTH = 20;\n\nexport const FieldTypes = Object.freeze({\n\tstring: 'string',\n\tenumeration: 'enumeration',\n\tdate: 'date',\n\tdatetime: 'datetime',\n\taddress: 'address',\n\turl: 'url',\n\tfile: 'file',\n\tmoney: 'money',\n\tboolean: 'boolean',\n\tdouble: 'double',\n\temployee: 'employee',\n\tcrm: 'crm',\n\tcrmStatus: 'crm_status',\n});\n\nexport const FieldDescriptions = Object.freeze({\n\tstring: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_STRING_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_STRING_LEGEND\"),\n\t\tdefaultTitle: Loc.getMessage('UI_USERFIELD_FACTORY_UF_STRING_LABEL'),\n\t},\n\tenumeration: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_ENUM_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_ENUM_LEGEND\"),\n\t\tdefaultTitle: Loc.getMessage('UI_USERFIELD_FACTORY_UF_ENUMERATION_LABEL'),\n\t},\n\tdatetime: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_DATETIME_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_DATETIME_LEGEND\"),\n\t\tdefaultTitle: Loc.getMessage('UI_USERFIELD_FACTORY_UF_DATETIME_LABEL'),\n\t},\n\taddress: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_ADDRESS_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_ADDRESS_LEGEND\"),\n\t},\n\turl: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_URL_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_URL_LEGEND\"),\n\t},\n\tfile: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_FILE_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_FILE_LEGEND\"),\n\t\tdefaultTitle: Loc.getMessage('UI_USERFIELD_FACTORY_UF_FILE_LABEL'),\n\t},\n\tmoney: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_MONEY_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_MONEY_LEGEND\"),\n\t\tdefaultTitle: Loc.getMessage('UI_USERFIELD_FACTORY_UF_MONEY_LABEL'),\n\t},\n\tboolean: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_BOOLEAN_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_BOOLEAN_LEGEND\"),\n\t},\n\tdouble: {\n\t\ttitle: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_DOUBLE_TITLE\"),\n\t\tdescription: Loc.getMessage(\"UI_USERFIELD_FACTORY_UF_DOUBLE_LEGEND\"),\n\t\tdefaultTitle: Loc.getMessage('UI_USERFIELD_FACTORY_UF_DOUBLE_LABEL'),\n\t},\n});\n\nexport const DefaultData = Object.freeze({\n\tMULTIPLE: 'N',\n\tMANDATORY: 'N',\n\tUSER_TYPE_ID: FieldTypes.string,\n\tSHOW_FILTER: 'E',\n\tSHOW_IN_LIST: 'Y',\n\tSETTINGS: {},\n\tIS_SHOW_ALWAYS: 'Y',\n});\n\nexport const DefaultFieldData = Object.freeze({\n\tfile: {\n\t\tSHOW_FILTER: 'N',\n\t\tSHOW_IN_LIST: 'N',\n\t},\n\temployee: {\n\t\tSHOW_FILTER: 'I',\n\t},\n\tcrm: {\n\t\tSHOW_FILTER: 'I',\n\t},\n\tcrm_status: {\n\t\tSHOW_FILTER: 'I',\n\t},\n\tenumeration: {\n\t\tSETTINGS: {\n\t\t\tDISPLAY: 'UI',\n\t\t},\n\t},\n\tdouble: {\n\t\tSETTINGS: {\n\t\t\tPRECISION: 2,\n\t\t},\n\t},\n});","import {Event, Type, Tag} from 'main.core';\nimport {PopupWindow} from 'main.popup';\n\nexport class CreationMenu\n{\n\tconstructor(id: string, types: Array, params: Object)\n\t{\n\t\tthis.id = id;\n\t\tthis.items = types;\n\t\tthis.params = {};\n\t\tif(Type.isPlainObject(params))\n\t\t{\n\t\t\tthis.params = params;\n\t\t}\n\t}\n\n\tgetId(): string\n\t{\n\t\tif(!this.id)\n\t\t{\n\t\t\treturn 'ui-user-field-factory-menu';\n\t\t}\n\n\t\treturn this.id;\n\t}\n\n\tgetPopup(onItemClick = null): PopupWindow\n\t{\n\t\tif(!this.popup)\n\t\t{\n\t\t\tlet options = {...CreationMenu.getDefaultPopupOptions(), ...this.params};\n\n\t\t\toptions.events = {\n\t\t\t\tonPopupShow: this.onPopupShow.bind(this),\n\t\t\t\tonPopupDestroy: this.onPopupDestroy.bind(this),\n\t\t\t};\n\n\t\t\tthis.popup = new PopupWindow(\n\t\t\t\tthis.getId(),\n\t\t\t\toptions.bindElement,\n\t\t\t\toptions\n\t\t\t);\n\t\t}\n\n\t\tthis.popup.setContent(this.render(onItemClick));\n\n\t\treturn this.popup;\n\t}\n\n\tstatic getDefaultPopupOptions(): Object\n\t{\n\t\treturn {\n\t\t\tautoHide: true,\n\t\t\tdraggable: false,\n\t\t\toffsetLeft: 0,\n\t\t\toffsetTop: 0,\n\t\t\tnoAllPaddings: true,\n\t\t\tbindOptions: { forceBindPosition: true },\n\t\t\tcloseByEsc: true,\n\t\t\tcacheable: false,\n\t\t};\n\t}\n\n\topen(callback: function): void\n\t{\n\t\tconst popup = this.getPopup(callback);\n\t\tif(!popup.isShown())\n\t\t{\n\t\t\tpopup.show();\n\t\t}\n\t}\n\n\trender(onItemClick): Element\n\t{\n\t\tif(!this.container)\n\t\t{\n\t\t\tthis.container = Tag.render`<div class=\"ui-userfieldfactory-creation-menu-container\"></div>`;\n\n\t\t\tconst scrollIcon = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"42\\\" height=\\\"13\\\" viewBox=\\\"0 0 42 13\\\">\\n\" +\n\t\t\t\t\"  <polyline fill=\\\"none\\\" stroke=\\\"#CACDD1\\\" stroke-width=\\\"2\\\" points=\\\"274 98 284 78.614 274 59\\\" transform=\\\"rotate(90 186 -86.5)\\\" stroke-linecap=\\\"round\\\" stroke-linejoin=\\\"round\\\"/>\\n\" +\n\t\t\t\t\"</svg>\\n\";\n\n\t\t\tthis.topScrollButton = Tag.render`<div class=\"ui-userfieldfactory-creation-menu-scroll-top\">${scrollIcon}</div>`;\n\t\t\tthis.bottomScrollButton = Tag.render`<div class=\"ui-userfieldfactory-creation-menu-scroll-bottom\">${scrollIcon}</div>`;\n\n\t\t\tthis.container.appendChild(this.topScrollButton);\n\t\t\tthis.container.appendChild(this.bottomScrollButton);\n\n\t\t\tthis.container.appendChild(this.renderList(onItemClick));\n\t\t}\n\n\t\treturn this.container;\n\t}\n\n\trenderList(onItemClick): Element\n\t{\n\t\tif(!this.containerList)\n\t\t{\n\t\t\tthis.containerList = Tag.render`<div class=\"ui-userfieldfactory-creation-menu-list\"></div>`;\n\n\t\t\tthis.items.forEach((item) =>\n\t\t\t{\n\t\t\t\tthis.containerList.appendChild(this.renderItem(item, onItemClick));\n\t\t\t});\n\t\t}\n\n\t\treturn this.containerList;\n\t}\n\n\trenderItem(item, onClick): Element\n\t{\n\t\treturn Tag.render`<div class=\"ui-userfieldfactory-creation-menu-item\" onclick=\"${(()=>{this.onItemClick(item, onClick);})}\">\n\t\t\t<div class=\"ui-userfieldfactory-creation-menu-item-title\">${item.title}</div>\n\t\t\t<div class=\"ui-userfieldfactory-creation-menu-item-desc\">${item.description}</div>\n\t\t</div>`;\n\t}\n\n\tonItemClick(item, onClick)\n\t{\n\t\tif(Type.isFunction(onClick))\n\t\t{\n\t\t\tonClick(item.name);\n\t\t}\n\t\tthis.getPopup().close();\n\t}\n\n\tonPopupShow()\n\t{\n\t\tEvent.bind(this.bottomScrollButton, \"mouseover\", this.onBottomButtonMouseOver.bind(this));\n\t\tEvent.bind(this.bottomScrollButton, \"mouseout\", this.onBottomButtonMouseOut.bind(this));\n\t\tEvent.bind(this.topScrollButton, \"mouseover\", this.onTopButtonMouseOver.bind(this));\n\t\tEvent.bind(this.topScrollButton, \"mouseout\", this.onTopButtonMouseOut.bind(this));\n\t\tEvent.bind(this.containerList, \"scroll\", this.onScroll.bind(this));\n\n\t\twindow.setTimeout(this.adjust.bind(this), 100);\n\t}\n\n\tonPopupDestroy()\n\t{\n\t\tEvent.unbind(this.bottomScrollButton, \"mouseover\", this.onBottomButtonMouseOver.bind(this));\n\t\tEvent.unbind(this.bottomScrollButton, \"mouseout\", this.onBottomButtonMouseOut.bind(this));\n\t\tEvent.unbind(this.topScrollButton, \"mouseover\", this.onTopButtonMouseOver.bind(this));\n\t\tEvent.unbind(this.topScrollButton, \"mouseout\", this.onTopButtonMouseOut.bind(this));\n\t\tEvent.unbind(this.containerList, \"scroll\", this.onScroll.bind(this));\n\n\t\tthis.container = null;\n\t\tthis.containerList = null;\n\t\tthis.topScrollButton = null;\n\t\tthis.bottomScrollButton = null;\n\n\t\tthis.popup = null;\n\t}\n\n\tonBottomButtonMouseOver()\n\t{\n\t\tif(this._enableScrollToBottom)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableScrollToBottom = true;\n\t\tthis._enableScrollToTop = false;\n\n\t\t(function scroll()\n\t\t{\n\t\t\tif(!this._enableScrollToBottom)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif((this.containerList.scrollTop + this.containerList.offsetHeight) !== this.containerList.scrollHeight)\n\t\t\t{\n\t\t\t\tthis.containerList.scrollTop += 3;\n\t\t\t}\n\n\t\t\tif((this.containerList.scrollTop + this.containerList.offsetHeight) === this.containerList.scrollHeight)\n\t\t\t{\n\t\t\t\tthis._enableScrollToBottom = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.setTimeout(scroll.bind(this), 20);\n\t\t\t}\n\t\t}).bind(this)();\n\t}\n\n\tonBottomButtonMouseOut()\n\t{\n\t\tthis._enableScrollToBottom = false;\n\t}\n\n\tonTopButtonMouseOver()\n\t{\n\t\tif(this._enableScrollToTop)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tthis._enableScrollToBottom = false;\n\t\tthis._enableScrollToTop = true;\n\n\t\t(function scroll()\n\t\t{\n\t\t\tif(!this._enableScrollToTop)\n\t\t\t{\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif(this.containerList.scrollTop > 0)\n\t\t\t{\n\t\t\t\tthis.containerList.scrollTop -= 3;\n\t\t\t}\n\n\t\t\tif(this.containerList.scrollTop === 0)\n\t\t\t{\n\t\t\t\tthis._enableScrollToTop = false;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twindow.setTimeout(scroll.bind(this), 20);\n\t\t\t}\n\t\t}).bind(this)();\n\t}\n\n\tonTopButtonMouseOut()\n\t{\n\t\tthis._enableScrollToTop = false;\n\t}\n\n\tonScroll()\n\t{\n\t\tthis.adjust();\n\t}\n\n\tadjust()\n\t{\n\t\tconst height = this.containerList.offsetHeight;\n\t\tconst scrollTop = this.containerList.scrollTop;\n\t\tconst scrollHeight = this.containerList.scrollHeight;\n\n\t\tif(scrollTop === 0)\n\t\t{\n\t\t\tthis.topScrollButton.classList.add('hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.topScrollButton.classList.remove('hidden');\n\t\t}\n\n\t\tif((scrollTop + height) === scrollHeight)\n\t\t{\n\t\t\tthis.bottomScrollButton.classList.add('hidden');\n\t\t}\n\t\telse\n\t\t{\n\t\t\tthis.bottomScrollButton.classList.remove('hidden');\n\t\t}\n\t}\n}","export class EnumItem\n{\n\tconstructor(value = null)\n\t{\n\t\tthis.value = value;\n\t}\n\n\tsetNode(node: Element)\n\t{\n\t\tthis.node = node;\n\t}\n\n\tgetNode(): ?Element\n\t{\n\t\treturn this.node;\n\t}\n\n\tgetInput(): ?Element\n\t{\n\t\tconst node = this.getNode();\n\t\tif(!node)\n\t\t{\n\t\t\treturn null;\n\t\t}\n\t\tif(node instanceof HTMLInputElement)\n\t\t{\n\t\t\treturn node;\n\t\t}\n\t\treturn node.querySelector('input');\n\t}\n\n\tgetValue(): string\n\t{\n\t\tconst input = this.getInput();\n\t\tif(input && input.value)\n\t\t{\n\t\t\treturn input.value;\n\t\t}\n\n\t\treturn this.value || '';\n\t}\n}","import {Text, Type} from 'main.core';\nimport {FieldTypes} from \"./fieldtypes\";\nimport {EnumItem} from \"./enumitem\";\n\nexport class Field\n{\n\tconstructor(data: Object)\n\t{\n\t\tthis.data = data;\n\t}\n\n\tgetId(): number\n\t{\n\t\treturn Text.toInteger(this.data.ID);\n\t}\n\n\tgetData(): Object\n\t{\n\t\treturn this.data;\n\t}\n\n\tgetName(): string\n\t{\n\t\treturn this.data.FIELD;\n\t}\n\n\tgetTypeId(): string\n\t{\n\t\treturn this.data.USER_TYPE_ID;\n\t}\n\n\tgetEnumeration(): Array\n\t{\n\t\tif(!Type.isArray(this.data.ENUM))\n\t\t{\n\t\t\tthis.data.ENUM = [];\n\t\t}\n\n\t\treturn this.data.ENUM;\n\t}\n\n\tsaveEnumeration(items: EnumItem[])\n\t{\n\t\tthis.data.ENUM = [];\n\t\tlet sort = 100;\n\n\t\titems.forEach((item) =>\n\t\t{\n\t\t\tthis.data.ENUM.push({\n\t\t\t\tVALUE: item.getValue(),\n\t\t\t\tSORT: sort,\n\t\t\t});\n\n\t\t\tsort += 100;\n\t\t});\n\t}\n\n\tstatic getTitleFields(): Array\n\t{\n\t\treturn Array.from([\n\t\t\t'EDIT_FORM_LABEL',\n\t\t\t'LIST_COLUMN_LABEL',\n\t\t\t'LIST_FILTER_LABEL',\n\t\t]);\n\t}\n\n\tgetTitle(): string\n\t{\n\t\tconst titleFields = Field.getTitleFields();\n\n\t\tconst titleFieldsCount = titleFields.length;\n\n\t\tfor(let index = 0; index < titleFieldsCount; index++)\n\t\t{\n\t\t\tif(Type.isString(this.data[titleFields[index]]) && this.data[titleFields[index]].length > 0)\n\t\t\t{\n\t\t\t\treturn this.data[titleFields[index]];\n\t\t\t}\n\t\t}\n\n\t\treturn this.getName();\n\t}\n\n\tsetTitle(title: string)\n\t{\n\t\tif(Type.isString(title) && title.length > 0)\n\t\t{\n\t\t\tField.getTitleFields().forEach((label) =>\n\t\t\t{\n\t\t\t\tthis.data[label] = title;\n\t\t\t});\n\t\t\tif(this.getTypeId() === FieldTypes.boolean)\n\t\t\t{\n\t\t\t\tthis.data.SETTINGS.LABEL_CHECKBOX = title;\n\t\t\t}\n\t\t}\n\t}\n\n\tisSaved(): boolean\n\t{\n\t\treturn (this.getId() > 0);\n\t}\n\n\tisShowAlways(): boolean\n\t{\n\t\treturn (this.data.IS_SHOW_ALWAYS === 'Y');\n\t}\n\n\tsetIsShowAlways(isShowAlways)\n\t{\n\t\tthis.data.IS_SHOW_ALWAYS = (Text.toBoolean(isShowAlways) === true ? 'Y' : 'N');\n\t}\n\n\tisMultiple(): boolean\n\t{\n\t\treturn (this.data.MULTIPLE === 'Y');\n\t}\n\n\tsetIsMultiple(isMultiple)\n\t{\n\t\tif(!this.isSaved())\n\t\t{\n\t\t\tthis.data.MULTIPLE = (Text.toBoolean(isMultiple) === true ? 'Y' : 'N');\n\t\t}\n\t}\n\n\tisDateField(): boolean\n\t{\n\t\treturn (this.getTypeId() === FieldTypes.datetime || this.getTypeId() === FieldTypes.date);\n\t}\n\n\tisShowTime(): boolean\n\t{\n\t\treturn (this.getTypeId() === FieldTypes.datetime);\n\t}\n\n\tsetIsShowTime(isShowTime)\n\t{\n\t\tif(!this.isSaved())\n\t\t{\n\t\t\tisShowTime = Text.toBoolean(isShowTime);\n\t\t\tif(isShowTime)\n\t\t\t{\n\t\t\t\tthis.data.USER_TYPE_ID = FieldTypes.datetime;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.data.USER_TYPE_ID = FieldTypes.date;\n\t\t\t}\n\t\t}\n\t}\n}","import {Type, Loc, Tag} from 'main.core';\nimport {Field} from './field';\nimport {FieldTypes} from \"./fieldtypes\";\nimport {EnumItem} from './enumitem';\n\nexport class Configurator\n{\n\tconstructor(params: {\n\t\tfield: Field,\n\t\tonSave: Function,\n\t\tonCancel: ?Function,\n\t})\n\t{\n\t\tif(Type.isPlainObject(params))\n\t\t{\n\t\t\tif(params.field instanceof Field)\n\t\t\t{\n\t\t\t\tthis.field = params.field;\n\t\t\t}\n\t\t\tif(Type.isFunction(params.onSave))\n\t\t\t{\n\t\t\t\tthis.onSave = params.onSave;\n\t\t\t}\n\t\t\tif(Type.isFunction(params.onCancel))\n\t\t\t{\n\t\t\t\tthis.onCancel = params.onCancel;\n\t\t\t}\n\t\t}\n\n\t\tthis.enumItems = new Set();\n\t}\n\n\trender(): Element\n\t{\n\t\tthis.node = Tag.render`<div class=\"ui-userfieldfactory-configurator\"></div>`;\n\n\t\tthis.labelInput = Tag.render`<input class=\"ui-ctl-element\" type=\"text\" value=\"${this.field.getTitle()}\" />`;\n\n\t\tthis.node.appendChild(Tag.render`<div class=\"ui-userfieldfactory-configurator-block\">\n\t\t\t<div class=\"ui-userfieldfactory-configurator-title\">\n\t\t\t\t<span class=\"ui-userfieldfactory-configurator-title-text\">${Loc.getMessage('UI_USERFIELD_FACTORY_CONFIGURATOR_FIELD_TITLE')}</span>\n\t\t\t</div>\n\t\t\t<div class=\"ui-userfieldfactory-configurator-content\">\n\t\t\t\t<div class=\"ui-ctl ui-ctl-textbox ui-ctl-w100\">\n\t\t\t\t\t${this.labelInput}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>`);\n\n\t\tif(this.field.getTypeId() === FieldTypes.enumeration)\n\t\t{\n\t\t\tthis.node.appendChild(this.renderEnumeration());\n\t\t}\n\n\t\tthis.node.appendChild(this.renderOptions());\n\n\t\tconst save = (event) =>\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tif(Type.isFunction(this.onSave))\n\t\t\t{\n\t\t\t\tthis.onSave(this.saveField());\n\t\t\t}\n\t\t};\n\n\t\tconst cancel = (event) =>\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tif(Type.isFunction(this.onCancel))\n\t\t\t{\n\t\t\t\tthis.onCancel();\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tthis.node.style.display = 'none';\n\t\t\t}\n\t\t};\n\n\t\tthis.saveButton = Tag.render`<span class=\"ui-btn ui-btn-primary\" onclick=\"${save.bind(this)}\">${Loc.getMessage('UI_USERFIELD_SAVE')}</span>`;\n\t\tthis.cancelButton = Tag.render`<span class=\"ui-btn ui-btn-light-border\" onclick=\"${cancel.bind(this)}\">${Loc.getMessage('UI_USERFIELD_CANCEL')}</span>`;\n\n\t\tthis.node.appendChild(Tag.render`<div class=\"ui-userfieldfactory-configurator-block\">\n\t\t\t${this.saveButton}${this.cancelButton}\n\t\t</div>`);\n\n\t\treturn this.node;\n\t}\n\n\tsaveField(): Field\n\t{\n\t\tif(this.timeCheckbox)\n\t\t{\n\t\t\tthis.field.setIsShowTime(this.timeCheckbox.checked);\n\t\t}\n\t\tif(this.showAlwaysCheckbox)\n\t\t{\n\t\t\tthis.field.setIsShowAlways(this.showAlwaysCheckbox.checked);\n\t\t}\n\t\tif(this.multipleCheckbox)\n\t\t{\n\t\t\tthis.field.setIsMultiple(this.multipleCheckbox.checked);\n\t\t}\n\t\tthis.field.setTitle(this.labelInput.value);\n\t\tthis.field.saveEnumeration(this.enumItems);\n\n\t\treturn this.field;\n\t}\n\n\trenderEnumeration(): Element\n\t{\n\t\tthis.enumItemsContainer = Tag.render`<div class=\"ui-userfieldfactory-configurator-block\"></div>`;\n\n\t\tthis.enumAddItemContainer = Tag.render`<div class=\"ui-userfieldfactory-configurator-block-add-field\">\n\t\t\t<span class=\"ui-userfieldfactory-configurator-add-button\" onclick=\"${() => {this.addEnumInput().focus();}}\">${Loc.getMessage('UI_USERFIELD_ADD')}</span>\n\t\t</div>`;\n\n\t\tthis.enumContainer = Tag.render`<div class=\"ui-userfieldfactory-configurator-block\">\n\t\t\t<div class=\"ui-userfieldfactory-configurator-title\">\n\t\t\t\t<span class=\"ui-userfieldfactory-configurator-title-text\">${Loc.getMessage('UI_USERFIELD_FACTORY_UF_ENUM_ITEMS')}</span>\n\t\t\t</div>\n\t\t\t${this.enumItemsContainer}\n\t\t\t${this.enumAddItemContainer}\n\t\t</div>`;\n\n\t\tthis.field.getEnumeration().forEach((item) =>\n\t\t{\n\t\t\tthis.addEnumInput(item);\n\t\t});\n\t\tthis.addEnumInput();\n\n\t\treturn this.enumContainer;\n\t}\n\n\taddEnumInput(item: Object|EnumItem = null): Element\n\t{\n\t\tif(!(item instanceof EnumItem))\n\t\t{\n\t\t\tif(Type.isPlainObject(item))\n\t\t\t{\n\t\t\t\titem = new EnumItem(item.VALUE);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\titem = new EnumItem();\n\t\t\t}\n\t\t}\n\n\t\tconst node = Tag.render`<div style=\"margin-bottom: 10px;\" class=\"ui-ctl ui-ctl-textbox ui-ctl-w100 ui-ctl-row\">\n\t\t\t<input class=\"ui-ctl-element\" type=\"text\" value=\"${item.getValue()}\">\n\t\t\t<div class=\"ui-userfieldfactory-configurator-remove-enum\" onclick=\"${(event) =>\n\t\t{\n\t\t\tevent.preventDefault();\n\t\t\tthis.deleteEnumItem(item);\n\t\t}}\"></div>\n\t\t</div>`;\n\n\t\titem.setNode(node);\n\n\t\tthis.enumItems.add(item);\n\n\t\tthis.enumItemsContainer.appendChild(node);\n\n\t\treturn node;\n\t}\n\n\tdeleteEnumItem(item: EnumItem)\n\t{\n\t\tthis.enumItemsContainer.removeChild(item.getNode());\n\t\tthis.enumItems.delete(item);\n\t}\n\n\trenderOptions(): Element\n\t{\n\t\tthis.optionsContainer = Tag.render`<div class=\"ui-userfieldfactory-configurator-block\"></div>`;\n\n\t\tif(!this.field.isSaved() && this.field.isDateField())\n\t\t{\n\t\t\tthis.timeCheckbox = Tag.render`<input class=\"ui-ctl-element\" type=\"checkbox\">`;\n\t\t\tthis.timeCheckbox.checked = this.field.isShowTime();\n\t\t\tthis.optionsContainer.appendChild(Tag.render`<div>\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-xs\">\n\t\t\t\t\t${this.timeCheckbox}\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('UI_USERFIELD_FACTORY_UF_ENABLE_TIME')}</div>\n\t\t\t\t</label>\n\t\t\t</div>`);\n\t\t}\n\n\t\tif(!this.field.isSaved() && this.field.getTypeId() !== FieldTypes.boolean)\n\t\t{\n\t\t\tthis.multipleCheckbox = Tag.render`<input class=\"ui-ctl-element\" type=\"checkbox\">`;\n\t\t\tthis.multipleCheckbox.checked = this.field.isMultiple();\n\t\t\tthis.optionsContainer.appendChild(Tag.render`<div>\n\t\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-xs\">\n\t\t\t\t\t${this.multipleCheckbox}\n\t\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('UI_USERFIELD_FACTORY_FIELD_MULTIPLE')}</div>\n\t\t\t\t</label>\n\t\t\t</div>`);\n\t\t}\n\n\t\tthis.showAlwaysCheckbox = Tag.render`<input class=\"ui-ctl-element\" type=\"checkbox\">`;\n\t\tthis.showAlwaysCheckbox.checked = this.field.isShowAlways();\n\t\tthis.optionsContainer.appendChild(Tag.render`<div>\n\t\t\t<label class=\"ui-ctl ui-ctl-checkbox ui-ctl-xs\">\n\t\t\t\t${this.showAlwaysCheckbox}\n\t\t\t\t<div class=\"ui-ctl-label-text\">${Loc.getMessage('UI_USERFIELD_FACTORY_FIELD_SHOW_ALWAYS')}</div>\n\t\t\t</label>\n\t\t</div>`);\n\n\t\treturn this.optionsContainer;\n\t}\n}","import {Loc, Type, Event} from \"main.core\";\n\nimport {CreationMenu} from \"./creationmenu\";\nimport {Field} from \"./field\";\nimport {MAX_FIELD_LENGTH, DefaultData, DefaultFieldData, FieldDescriptions} from \"./fieldtypes\";\nimport {Configurator} from \"./configurator\";\n\nimport 'uf';\n\nexport class Factory\n{\n\tconstructor(entityId: string, params: {\n\t\tcreationSignature: string,\n\t\tmenuId: ?string,\n\t\ttypes: ?Array,\n\t\tbindElement: ?Element,\n\t\tconfiguratorClass: ?Configurator,\n\t} = {})\n\t{\n\t\tthis.configuratorClass = Configurator;\n\t\tif(Type.isString(entityId) && entityId.length > 0)\n\t\t{\n\t\t\tthis.entityId = entityId;\n\t\t}\n\t\tif(Type.isPlainObject(params))\n\t\t{\n\t\t\tif(Type.isString(params.creationSignature))\n\t\t\t{\n\t\t\t\tthis.creationSignature = params.creationSignature;\n\t\t\t}\n\t\t\tif(Type.isString(params.menuId))\n\t\t\t{\n\t\t\t\tthis.menuId = params.menuId;\n\t\t\t}\n\t\t\tif(!Type.isArray(params.types))\n\t\t\t{\n\t\t\t\tparams.types = [];\n\t\t\t}\n\t\t\tif(Type.isDomNode(params.bindElement))\n\t\t\t{\n\t\t\t\tthis.bindElement = params.bindElement;\n\t\t\t}\n\t\t\tif(Type.isObject(params.configuratorClass) && params.configuratorClass instanceof Configurator)\n\t\t\t{\n\t\t\t\tthis.configuratorClass = params.configuratorClass;\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tparams.types = [];\n\t\t}\n\t\tthis.types =  Factory.getFieldTypes().concat(params.types);\n\t}\n\n\tstatic getFieldTypes(): Array\n\t{\n\t\tconst types = [];\n\n\t\tObject.keys(FieldDescriptions).forEach((name) =>\n\t\t{\n\t\t\ttypes.push({...FieldDescriptions[name], ...{name}});\n\t\t});\n\n\t\tconst eventName = 'UI:UserFieldFactory:Factory:OnGetAdditionalUserTypes';\n\t\tconst additionalItems = [];\n\t\tEvent.EventEmitter.emit(eventName, {\n\t\t\tadditionalItems\n\t\t});\n\t\tif(Type.isArray(additionalItems))\n\t\t{\n\t\t\tadditionalItems.forEach(({name, title, description}) =>\n\t\t\t{\n\t\t\t\tif(Type.isString(name) && Type.isString(title) && Type.isString(description))\n\t\t\t\t{\n\t\t\t\t\ttypes.push({name, title, description});\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn types;\n\t}\n\n\tgetMenu(params: Object): CreationMenu\n\t{\n\t\tif(!Type.isPlainObject(params))\n\t\t{\n\t\t\tparams = {};\n\t\t}\n\t\tif(!Type.isDomNode(params.bindElement))\n\t\t{\n\t\t\tparams.bindElement = this.bindElement;\n\t\t}\n\t\tif(!this.menu)\n\t\t{\n\t\t\tthis.menu = new CreationMenu(this.menuId, this.types, params);\n\t\t}\n\n\t\treturn this.menu;\n\t}\n\n\tgetConfigurator(params: {\n\t\tfield: Field,\n\t\tonSave: Function,\n\t\tonCancel: ?Function,\n\t}): Configurator\n\t{\n\t\treturn new this.configuratorClass(params);\n\t}\n\n\tcreateField(fieldType: string, fieldName: ?string): Field\n\t{\n\t\tlet data = {...DefaultData, ...DefaultFieldData[fieldType], ...{USER_TYPE_ID: fieldType}};\n\n\t\tif(!Type.isString(fieldName) || fieldName.length <= 0 || fieldName.length > MAX_FIELD_LENGTH)\n\t\t{\n\t\t\tfieldName = this.generateFieldName();\n\t\t}\n\t\tdata.FIELD = fieldName;\n\t\tdata.ENTITY_ID = this.entityId;\n\t\tdata.SIGNATURE = this.creationSignature;\n\n\t\tconst field = new Field(data);\n\t\tfield.setTitle(this.getDefaultLabel(fieldType));\n\n\t\tEvent.EventEmitter.emit('UI.UserFieldFactory.Factory.onCreateField', {\n\t\t\tfactory: this,\n\t\t\tfield,\n\t\t});\n\n\t\treturn field;\n\t}\n\n\tgetDefaultLabel(fieldType: string): string\n\t{\n\t\tlet label = Loc.getMessage('UI_USERFIELD_FACTORY_UF_LABEL');\n\t\tthis.types.forEach((type) =>\n\t\t{\n\t\t\tif(type.name === fieldType && Type.isString(type.defaultTitle))\n\t\t\t{\n\t\t\t\tlabel = type.defaultTitle;\n\t\t\t}\n\t\t});\n\n\t\treturn label;\n\t}\n\n\tgenerateFieldName(): string\n\t{\n\t\tlet name = 'UF_' + (this.entityId ? (this.entityId + \"_\") : \"\");\n\t\tlet dateSuffix = (new Date()).getTime().toString();\n\t\tif(name.length + dateSuffix.length > MAX_FIELD_LENGTH)\n\t\t{\n\t\t\tdateSuffix = dateSuffix.substr(((name.length + dateSuffix.length) - MAX_FIELD_LENGTH));\n\t\t}\n\n\t\tname += dateSuffix;\n\n\t\treturn name;\n\t}\n\n\tsaveField(field: Field): Promise<?Field, Array>\n\t{\n\t\treturn new Promise((resolve, reject) =>\n\t\t{\n\t\t\tif(field instanceof Field)\n\t\t\t{\n\t\t\t\tif(field.isSaved())\n\t\t\t\t{\n\t\t\t\t\tBX.Main.UF.EditManager.update({ \"FIELDS\": [field.getData()]}, (response) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onFieldSave(response, resolve, reject);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tBX.Main.UF.EditManager.add({ \"FIELDS\": [field.getData()]}, (response) =>\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.onFieldSave(response, resolve, reject);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\treject(['Wrong parameter: field must be instance of Field']);\n\t\t\t}\n\t\t});\n\t}\n\n\tonFieldSave(response, onSuccess: Function, onError: Function): void\n\t{\n\t\tif(Type.isPlainObject(response))\n\t\t{\n\t\t\tif(response.ERROR && Type.isArray(response.ERROR) && response.ERROR.length > 0)\n\t\t\t{\n\t\t\t\tonError(response.ERROR);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tconst fieldData = this.getFieldDataFromResponse(response);\n\t\t\t\tif(fieldData)\n\t\t\t\t{\n\t\t\t\t\tconst field = new Field(fieldData);\n\t\t\t\t\tif(Type.isFunction(onSuccess))\n\t\t\t\t\t{\n\t\t\t\t\t\tonSuccess(field);\n\t\t\t\t\t}\n\t\t\t\t\tEvent.EventEmitter.emit('UI.UserFieldFactory.Factory.onFieldSave', {\n\t\t\t\t\t\tfactory: this,\n\t\t\t\t\t\tfield,\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif(Type.isFunction(onError))\n\t\t\t{\n\t\t\t\tonError(['Error trying save user field settings']);\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFieldDataFromResponse(response: Object): ?Object\n\t{\n\t\tif(Type.isPlainObject(response))\n\t\t{\n\t\t\tlet fieldData;\n\t\t\tObject.keys(response).forEach((fieldName) =>\n\t\t\t{\n\t\t\t\tif(Type.isPlainObject(response[fieldName]['FIELD']))\n\t\t\t\t{\n\t\t\t\t\tfieldData = response[fieldName]['FIELD'];\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn fieldData;\n\t\t}\n\n\t\treturn null;\n\t}\n}","import {FieldTypes} from './fieldtypes';\nimport {Factory} from './factory';\nimport {Field} from './field';\nimport {Configurator} from './configurator';\n\nexport const UserFieldFactory = {\n\tFactory,\n\tFieldTypes,\n\tField,\n\tConfigurator,\n};"],"names":["MAX_FIELD_LENGTH","FieldTypes","Object","freeze","string","enumeration","date","datetime","address","url","file","money","boolean","double","employee","crm","crmStatus","FieldDescriptions","title","Loc","getMessage","description","defaultTitle","DefaultData","MULTIPLE","MANDATORY","USER_TYPE_ID","SHOW_FILTER","SHOW_IN_LIST","SETTINGS","IS_SHOW_ALWAYS","DefaultFieldData","crm_status","DISPLAY","PRECISION","CreationMenu","id","types","params","items","Type","isPlainObject","onItemClick","popup","options","getDefaultPopupOptions","events","onPopupShow","bind","onPopupDestroy","PopupWindow","getId","bindElement","setContent","render","callback","getPopup","isShown","show","container","Tag","scrollIcon","topScrollButton","bottomScrollButton","appendChild","renderList","containerList","forEach","item","renderItem","onClick","isFunction","name","close","Event","onBottomButtonMouseOver","onBottomButtonMouseOut","onTopButtonMouseOver","onTopButtonMouseOut","onScroll","window","setTimeout","adjust","unbind","_enableScrollToBottom","_enableScrollToTop","scroll","scrollTop","offsetHeight","scrollHeight","height","classList","add","remove","autoHide","draggable","offsetLeft","offsetTop","noAllPaddings","bindOptions","forceBindPosition","closeByEsc","cacheable","EnumItem","value","node","getNode","HTMLInputElement","querySelector","input","getInput","Field","data","Text","toInteger","ID","FIELD","isArray","ENUM","sort","push","VALUE","getValue","SORT","titleFields","getTitleFields","titleFieldsCount","length","index","isString","getName","label","getTypeId","LABEL_CHECKBOX","isShowAlways","toBoolean","isMultiple","isSaved","isShowTime","Array","from","Configurator","field","onSave","onCancel","enumItems","Set","labelInput","getTitle","renderEnumeration","renderOptions","save","event","preventDefault","saveField","cancel","style","display","saveButton","cancelButton","timeCheckbox","setIsShowTime","checked","showAlwaysCheckbox","setIsShowAlways","multipleCheckbox","setIsMultiple","setTitle","saveEnumeration","enumItemsContainer","enumAddItemContainer","addEnumInput","focus","enumContainer","getEnumeration","deleteEnumItem","setNode","removeChild","delete","optionsContainer","isDateField","Factory","entityId","configuratorClass","creationSignature","menuId","isDomNode","isObject","getFieldTypes","concat","menu","fieldType","fieldName","generateFieldName","ENTITY_ID","SIGNATURE","getDefaultLabel","EventEmitter","emit","factory","type","dateSuffix","Date","getTime","toString","substr","Promise","resolve","reject","BX","Main","UF","EditManager","update","getData","response","onFieldSave","onSuccess","onError","ERROR","fieldData","getFieldDataFromResponse","keys","eventName","additionalItems","UserFieldFactory"],"mappings":"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"}